<!DOCTYPE html><html><head><meta charset="utf8"><title>групповое копирование и переименование директорий и файлов</title><script>if( process.env.NODE_ENV == 'dev'){
  var stylus = require('stylus')
  var str    = require('fs').readFileSync(__dirname + '/../stylus/index.styl', 'utf8')
  stylus(str)
    .set('filename', __dirname + '/../stylus/index.styl', 'utf8')
    .render(function(err, css){
      if (err) throw err
        var style = document.createElement('style')
        style.innerText = css
        style.type = 'text/css'
        document.head.appendChild(style)
    })
}else{
  var str  = require('fs').readFileSync(__dirname + './../css/index.css', 'utf8')
  var style = document.createElement('style')
  style.innerText = str
  style.type = 'text/css'
  document.head.appendChild(style)
}</script><script src="./../js/tabToggle.js"></script><!--if NODE_ENV == 'dev'--><!--  script(src="./../js/tabToggle.js")--><!--else--><!--  script(src="./resources/app/js/tabToggle.js")--></head><table><tbody><tr><td><div class="panToggle" id="leftPan"><div></div></div><div class="content"><script src="./../js/userDataEqual.js"></script><div class="userPath"><p><button id="sourceDirectory">исходная директория</button><span> укажите исходную директорию</span></p><p><button id="xlsxDirectory">xlsx файлы</button><span>укажите директорию с промежуточными xlsx файлами</span></p><p><button id="targetDirectory">конечная директория</button><span>укажите конечную директорию</span></p></div><hr><p><select class="baseListUi"></select><span>укажите основную базу</span></p><label><input type="checkbox" checked name="dirInDir"/> директория с поддиекториями</label><br><label><input type="checkbox" checked name="xlsx"> использовать промежуточные xlsx файлы</label><br><label><input type="checkbox" checked name="dash"> копировать несколько одинаковых условий в один файл с разделенным названием через тире</label><!-- "_"--><p>1. <input type="text" placeholder="_" name="splitDir"><span>разделитель имени директории</span></p><!-- "_"--><p>2. <input type="text" placeholder="_" name="splitFile"><span>разделитель имени файла</span></p><!-- 1; ;1,2; ;2--><p>3. <input type="text" placeholder="1;_;1,2;_;2" name="splitXlsx"><span>разделитель xlsx</span></p><!-- 1; ;1,2; ;2--><p>4. <input type="text" placeholder="1;_;1,2;_;2" name="splitBase"><span>разделитель базы</span></p><!-- столбец;имя директории 1;1 or 1--><p>5. <input type="text" placeholder="1;1" name="equalBaseDir"><span>сравнение имя директории с базой</span></p><!-- столбец;имя файла 1;1 or 1--><p>6. <input type="text" placeholder="1;1" name="equalBaseFile"><span>сравнение (имя файла/столбец из xlsx) с базой</span></p><!--1;_;1 or 1 or 1;_;1:userName or 1:userName or :userName--><p>7. <input type="text" placeholder=":name" name="endDir"><span>конечное имя директории</span></p><p>8. <input type="text" placeholder="1;_;1:name" name="endFile"><span>конечное имя файла</span></p><button id="runCopyAndRaname">старт</button><hr><p><button id="sourceLog">указать</button><span>укажите лог файл на основе которого создать таблицу</span></p><p><button id="targetLog">указать</button><span>укажите место сохранения таблицы и название</span></p><p><button id="copySuccess">старт</button><span>создать таблицу о успешно копированных файлов</span></p><p><button id="copyNot">старт</button><span>создать таблицу о не копированных файлов</span></p><hr><div class="mainDescript"><p>Процесс сравнения происходит следующим образом: <a href="">подробней</a></p><ul><li>Сканируеться каждая строчка основной базы данных для каждого имени файла/папки и проверяет ваше условие на истинность</li><li>В сравнении вы должны указавать только в каком столбце сравнивать имя файла/папки</li><li>Если все условия истины, тогда файл копируеться в указанную директорию, с указанным именем (имена указываються из основной базы)</li></ul><p><b>*</b> Директория с поддиректориями<ul><li>Указываеться директория в которой находяться поддиректории, в которых находяться конечные файлы (файлы могут быть любого расширения)</li></ul></p><p><b>*</b> Использование промежуточных xlsx файлов<ul><li>Указываеться аналогичная директория в которой есть xlsx файлы с аналогичным названием поддиректорий и исходных файлов, если название поддиректорий или название файла xlsx не будут совпадать с исходными файлами, то они будут пропущены</li><li>Это нужно в ситуациях, если вам необходимо копировать один файл не по его одному имени файла, а по нескольким разным именам которые указанны в xlsx, поэтому вы должны описать несколько строк с нужными значениями в аналочином xlsx файле. <br> Чаще всего это применяеться к изображениям(документ), отсканированным с помощью fineReader и сохраненными в xlsx файле</li></ul></p><p><b>*</b> Разделить<ul><li>Разделителем может служить любой символ кроме <q>;</q>  <q>,</q>  <q>:</q></li><li>Подсказка: Можно указывать пробел <q>1; ;1</q></li></ul></p><p><b>*</b> Совет: Перед использованием xlsx, форматируйте дату как текст</p></div><div class="descript"><h4>1. Разделитель имени директории/файла</h4><ul><li>Разбивает имя директории на несколько элементов по разделителю. <br></li><li>Пример: имя <q>1558_август</q>, разделитель <q>_</q> <br></li><li>В данном примере разделитель нижнее подчеркивание разобъет имя директории на два имени, то есть - <q>1558</q> и <q>август</q> <br></li><li>Если вы хотите использовать имя целиком, оставьте это поле пустым</li><li>В других полях ввода вам нужно будет указывать какую часть имени вы хотите использовать, поэтому, вы должны понимать что при разделении имени <q>1558_август</q> по разделителю <q>_</q> у вас получиться две части 1 - <q>1558</q> 2 - <q>август</q></li></ul></div><div class="descript"><h4>2. Разделитель имени файла</h4><span>смотреть 1 пункт</span></div><div class="descript"><h4>3. Разделитель xlsx</h4><ul><li>Если вы используете промежуточные файлы екселя, то можно предварительно разделить имена в ячейках по разделителю, этот же принцип относиться и к общей базе</li><li>смотреть 4 пункт</li></ul></div><div class="descript"><h4>4. Разделитель базы</h4><ul><li>Предварительное разделение имен в ячейках по разделителю</li><li>Пример: <q>1;_;1</q> (<q>столбец;разделитель;используемая часть имени</q>)</li><li>В данном случае указываеться - использовать значение из первого столбеца в каждой строчки, разделить имя по знаку <q>_</q> и именить значение ячейки на первую часть имени</li><li>Так же можно менять несколько столбцов перечисляя значения через папятую <q>1;_;1,2;_;1</q></li><li>Если вы не хотите менять содержимое ячеек можно оставить это поле пустым</li></ul></div><div class="descript"><h4>5. Сравнение имя директории с базой</h4><ul><li>Указываеться номер столбца из базы и часть имени директории</li><li>Пример: <q>1;1</q> (<q>столбец;1</q>)</li><li>В данном случае указываеться - использовать значение из первого столбеца в каждой строчки и сравнить с именем текущей директории/файла</li><li>Если вы предварительно указали разделитель имени деректории, то необходимо указать какую часть имени нужно сравнивать с ячейкой из общей таблици</li><ul><li>Пример: <q>1558_август</q> разделитель <q>_</q></li><li><q>1;2</q></li><li>Тогда в первом столбце будет сравниваться на совпадение вторая часть имени, то есть <q>август</q></li></ul><li>Если вы предварительно не разбивали имя директории, можете указать только имя столбца из общей таблици, то есть <q>1</q>, тогда будет сравнивать имя директории целиком</li></ul></div><div class="descript"><h4>6. сравнение (имя файла/значения из xlsx) с базой</h4><ul><li>если используетються промежуточные xlsx файлы, тогда вторым параметром укаазываеться столбец из xlsx</li><li>если используетються имя файла, тогда вторым параметром укаазываеться часть имени, или имя целиком (1)</li><li>смотреть 5 пункт</li></ul></div><div class="descript"><h4>7. Конечное имя директории</h4><ul><li>Конечное имя директории/файла можно задать из таблици, так же добавить свое название к названию из таблици, или прописать статичное название</li><li>после знака <q>:</q> нужно указывать статическое имя ( не обяз. )</li><li>Пример 1: <q>1;_;1:name</q> (<q>столбец;разделитель;используемая часть имени:добавочное имя</q>)<ul><li>Использовать название из <q>1</q> колонки,</li><li>Разделить его по знаку <q>_</q></li><li>Использовать получившуюся <q>1</q> (первую) часть имени</li><li>Добавить к нему свое <q>:name</q></li></ul></li><li>Пример 2: <q>1</q><ul><li>Использовать название из <q>1</q> колонки,</li></ul></li><li>Пример 3: <q>1:name</q><ul><li>Использовать название из <q>1</q> колонки,</li><li>Добавить к нему свое <q>:name</q></li></ul></li><li>Пример 4: <q>:name</q><ul><li>Все файлы/директории будут называться <q>name</q></li></ul></li></ul></div><div class="descript"><h4>8. Конечное имя файла</h4><span>смотреть 7 пункт</span></div></div></td><td><div class="panToggle" id="rightPan"><div></div></div><div class="content"><script src="../js/userConfig.js"></script><p>Перед использованием программы, для быстродействия, необходимо конвертировать xlsx базу </p><p style="background-color:#fff7eb;"><b>*</b> Совет: Перед конвентированием xlsx, форматируйте в екселе дату как текст</p><p>загрузить базу</p><button id="sel_dataXlsx">указать базу xlsx</button><input type="text" placeholder="новое имя базы" id="nameJsonBase"><button id="convertXlsxToJson">конвертировать и сохранить</button><p>удалить указаную базу</p><select class="baseListUi"></select><button id="removeJson">удалить</button><hr><p>загрузить конфигурацию</p><select class="usConfUi"></select><button id="loadConfig">загрузить</button><p>сохранить конфигурацию <br>
сохраняет заполненые вами поля</p><input type="text" placeholder="имя конфигурации" id="nameConfig"><button id="saveConfig">сохранить</button><p>удалить конфигурацию</p><select class="usConfUi"></select><button id="removeConfig">удалить</button></div></td></tr></tbody></table></html>